<?phpclass Databases_Tables_Admin extends Zend_Db_Table{    protected $_name = 'admin';    var $admin_wechat_openid;    var $session_id;        function IsValid()    {    	$result = array();    	    	if($this->admin_wechat_openid)    	{    		$row = $this->fetchRow("admin_wechat_openid='".$this->admin_wechat_openid."' and admin_status=1");    		    		if(!empty($row))    		{    			$result = $row->toArray();    		}    	}    	    	return $result;    }        function GenerateSession()    {    	if($this->admin_wechat_openid)    	{    		$row = $this->fetchRow("admin_wechat_openid='".$this->admin_wechat_openid."'");    		    		$a = "lK2d3Hks3G87";    		$b = $row['admin_id'];    		$c = date("mYd");    		    		$result = sha1($a.$b.$c);    		    		//add into table    		$row->admin_session = $result;    		$row->save();    	}else{    		$result = "";    	}    	    	return $result;    }        function CheckInitialValidation()    {    	$result = FALSE;    	    	if($this->session_id)    	{    		$row = $this->fetchRow("admin_session='".$this->session_id."'");    		    		if(!empty($row))    		{    			$a = "lK2d3Hks3G87";    			$b = $row['admin_id'];    			$c = date("mYd");    			    			$target_session = sha1($a.$b.$c);    			    			if($target_session === $this->session_id)    			{    				$result = TRUE;    			}    		}    	}    	    	return $result;    }        function CheckCurrentSessionValidation()    {    	$result = FALSE;    	    	if($_SESSION['admin_session'])    	{    		$row = $this->fetchRow("admin_session = '".$_SESSION['admin_session']."' and admin_status=1");    		    		if(!empty($row))    		{    			$result = TRUE;    		}    	}    	    	return $result;    }}